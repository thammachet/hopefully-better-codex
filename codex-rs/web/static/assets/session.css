/* Session page overrides and extras. Shared styles live in /assets/index.css */

/* Always-compact header for session page */
.app-header{ padding:6px 12px !important; grid-template-columns:1fr auto; gap:8px }
/* Ensure header grid children can shrink */
.app-header > *{ min-width:0 }
.nav{ display:none }
.brand .home{ padding:4px 8px; gap:6px; border-radius:8px }
.brand .logo{ font-size:14px }
.brand .name{ display:none }
.status{ gap:6px; flex-wrap:nowrap; overflow:hidden }
.pill{ font-size:11px; padding:2px 6px }
#approval-pill, #sandbox-pill, #cwd-pill{ display:none }
.actions .btn{ padding:6px 8px }

/* Icon buttons in top bar */
.actions .btn.icon{ display:inline-flex; align-items:center; gap:6px; padding:6px 8px; border-radius:10px }
.actions .btn.icon .svg-icon{ width:16px; height:16px; display:inline-block; color:currentColor }
.actions .btn.icon .label{ display:none }
@media (min-width: 1000px){ .actions .btn.icon .label{ display:inline } }

/* Layout tweaks */
.controls-card{ margin-bottom:12px }
.field-wide{ min-width:240px }
.container{ transition: margin-top var(--fast) ease }

/* Make feed dominate on wide screens */
.grid2{ grid-template-columns: 2fr 1fr; align-items:start; gap:10px }
.feed-card{ grid-row: span 2; display:flex; flex-direction:column }
.feed{ max-height:none; }

/* Chat composer */
#chat{ width:100%; min-height:36px; max-height:40vh; resize:none; overflow:hidden; border-radius:10px; border:1px solid var(--line); background:var(--bg-soft); color:var(--fg); padding:6px 10px; line-height:1.35 }
#chat:focus{ outline:2px solid var(--accent); outline-offset:2px }

/* Mobile refinements */
@media (max-width: 900px){
  .grid2{ grid-template-columns: 1fr }
}
@media (max-width: 700px){
  #plan .plan-item{ padding:5px 6px }
}

/* Compact viewport support (~750x370) */
@media (max-height: 420px){
  .container{ padding:10px }
  .card{ padding:12px }
  .plan{ max-height: 20vh; overflow:auto }
  /* keep header tighter */
  .app-header{ padding:8px 12px }
}
@media (max-width: 800px){
  /* prevent title from wrapping badly next to pill */
  #title{ white-space:nowrap; overflow:hidden; text-overflow:ellipsis }
  #reason-pill{ white-space:nowrap }
}

/* Tool/activity blocks (exec, patch, MCP, search) */
.tool{ border:1px solid var(--line); border-radius:10px; padding:8px 10px; margin:8px 0; background:rgba(255,255,255,0.02); animation:fadeIn var(--fast) ease both }
.tool-head{ display:flex; align-items:center; justify-content:space-between; gap:8px; cursor:pointer; user-select:none; font-size:13px }
.tool-head:focus{ outline:2px solid var(--accent); outline-offset:2px }
.tool-left{ display:flex; align-items:center; gap:8px; min-width:0; flex-wrap:wrap }
.tool-icn{ width:16px; height:16px; display:inline-flex; align-items:center; justify-content:center; opacity:.9 }
.tool-title{ font-weight:600; white-space:normal; overflow-wrap:anywhere }
.tool-sub{ font-size:11px; color:var(--muted); white-space:normal; overflow-wrap:anywhere }
.tool-sep{ color:var(--muted) }
.tool-status{ display:flex; align-items:center; gap:8px }
.tool-body{ margin-top:6px; max-height:600px; overflow:hidden; opacity:1; transition: max-height var(--fast) ease, opacity var(--fast) ease }
.tool .pre{ background:#080b10; color:#fff; border:1px solid var(--line); border-radius:8px; padding:8px; max-height:200px; overflow:auto; font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace; white-space:pre-wrap; word-break:break-word; font-size:12px }
.tool .pre code{ color:#fff }
.tool.ok .pill{ background:#1a2a1f; color:#9be7a0; border-color:#24422a }
.tool.err .pill{ background:#2a1f1f; color:#ffb3b8; border-color:#3c2a2a }
.spin{ width:12px; height:12px; border-radius:50%; border:2px solid rgba(255,255,255,.28); border-top-color:#fff; animation:spin .8s linear infinite; display:inline-block }

/* Collapsed mode */
.tool.collapsed .tool-body{ max-height:0; opacity:0 }
.tool-preview{ display:none; font-size:11px; color:var(--muted); white-space:normal; overflow-wrap:anywhere }
.tool.collapsed .tool-preview{ display:inline }

/* Status dot indicator */
.dot{ width:10px; height:10px; border-radius:50%; background:var(--muted); display:inline-block }
.dot-run{ background:var(--accent) }
.dot-ok{ background:#2ea043 }
.dot-err{ background:#ff4d5f }
/* Hide text pill in compact mode; keep for a11y if needed */
.tool-status .pill{ display:none }

/* Patch summary list */
.patch-list{ display:flex; flex-direction:column; gap:6px; margin-top:6px }
.patch-file{ border:1px solid var(--line); border-radius:8px; padding:6px 8px; background:rgba(255,255,255,0.02) }
.patch-file-head{ display:flex; align-items:center; justify-content:space-between; gap:8px; cursor:pointer; user-select:none }
.patch-file-name{ white-space:nowrap; overflow:hidden; text-overflow:ellipsis; font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace; font-size:12px }
.patch-chips{ display:flex; align-items:center; gap:6px }
.chip{ font-size:11px; padding:1px 6px; border-radius:999px; border:1px solid var(--line) }
.chip-add{ background:#1a2a1f; color:#9be7a0; border-color:#24422a }
.chip-rem{ background:#2a1f1f; color:#ffb3b8; border-color:#3c2a2a }
.patch-diff{ display:none; margin-top:6px }
.patch-diff pre{ margin:0; background:#080b10; color:#fff; overflow:auto; max-width:100%; white-space:pre }
.patch-diff code{ color:#fff }
.patch-file.open .patch-diff{ display:block }

/* Group container */
.tool-group{ display:flex; flex-direction:column; gap:6px; margin:6px 0 2px }
.tool-group-head{ display:flex; align-items:center; justify-content:space-between; gap:8px; font-size:12px; color:var(--muted) }
.tool-group-title{ font-weight:600 }
@keyframes spin{ to{ transform:rotate(360deg) } }
@keyframes fadeIn{ from{ opacity:0; transform:translateY(2px) } to{ opacity:1; transform:translateY(0) } }
@keyframes fadeInUp{ from{ opacity:0; transform:translateY(6px) } to{ opacity:1; transform:translateY(0) } }

/* Card density tweaks for Session / Chat / Plan */
.feed-card, .composer, .plan-card{ padding:12px }
.feed-card, .composer, .plan-card{ min-width:0 }
.feed{ padding:10px }
.turn{ padding:8px 6px }
.msg{ padding:4px 4px }
.msg{ animation: fadeInUp var(--fast) ease both }
.msg-head{ margin-bottom:2px }
.md p{ margin:4px 0 }
.md ul{ margin:4px 0 4px 16px }
.new-indicator{ bottom:6px }
.card h3{ margin:0 0 6px }
/* composer actions row */
.composer .right{ display:flex; gap:8px; justify-content:flex-end; margin-top:6px }

/* Plan visuals: compact items with status accent */
.plan{ display:flex; flex-direction:column; gap:4px }
.plan > .muted{ margin-bottom:4px }
.plan-item{ display:flex; align-items:center; gap:8px; padding:4px 6px; border:1px solid var(--line); border-radius:8px; background:rgba(255,255,255,0.02); position:relative; animation: fadeInUp var(--fast) ease both }
.plan-item:hover{ border-color:#2a3550; background:rgba(255,255,255,0.04) }
.plan-item::before{ content:""; position:absolute; left:-1px; top:-1px; bottom:-1px; width:3px; border-top-left-radius:8px; border-bottom-left-radius:8px; background:#31405e }
.plan-step{ flex:1 }
.badge{ font-size:10px; padding:1px 6px }
.b-pending{ background:#2a2a1f; color:#f0e68c; border-color:#3a3a2a }
.b-inprogress{ background:#1f2a2a; color:#98f5e1; border-color:#2a3a3a }
.b-completed{ background:#1a2a1f; color:#9be7a0; border-color:#24422a }
.plan-item.b-pending::before{ background:#6b6b39 }
.plan-item.b-inprogress::before{ background:#2d5d5d }
.plan-item.b-completed::before{ background:#2e6a3a }

/* Tighten controls spacing inside controls card if needed */
.controls{ gap:6px }
.controls select, .controls input[type=text]{ min-width: 120px }

/* Minimal system message styling */
.msg-system{ background:transparent; border-left:2px solid var(--line); padding:4px 8px; margin:6px 0 }
.msg-system .msg-head{ display:none }
.msg-system::before{ content:'System'; display:inline-block; font-size:11px; color:var(--muted); border:1px solid var(--line); border-radius:999px; padding:1px 6px; margin-right:8px; background:transparent }
.msg-system .md{ display:-webkit-box; -webkit-line-clamp:2; -webkit-box-orient:vertical; overflow:hidden; color:var(--muted); font-size:12px }
.msg-system.expanded .md{ -webkit-line-clamp:unset; display:block }
.msg-system .show-more{ margin-left:8px; font-size:11px; border:1px solid var(--line); background:transparent; color:var(--fg); border-radius:6px; padding:0 6px; cursor:pointer }

/* Smoothly expand/collapse Reasoning body */
.reasoning .body{ max-height:600px; overflow:hidden; opacity:1; transition: max-height var(--fast) ease, opacity var(--fast) ease }
.reasoning.collapsed .body{ max-height:0; opacity:0 }
