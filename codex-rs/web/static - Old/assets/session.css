/** Session page overrides and extras. Shared styles live in /assets/index.css */

/* Layout tweaks */
.controls-card{ margin-bottom:12px }
.field-wide{ min-width:240px }

/* Make feed dominate on wide screens */
.grid2{ grid-template-columns: 2fr 1fr; align-items:start }
.feed-card{ grid-row: span 2 }
.feed{ max-height:65vh; scroll-behavior:smooth; position:relative }

/* Modern chat bubbles */
.msg{ display:flex; align-items:flex-start; gap:10px; padding:8px 10px }
.msg + .msg{ margin-top:-6px } /* tighten groups slightly */
.avatar{
  flex:0 0 auto; width:28px; height:28px; border-radius:50%;
  display:flex; align-items:center; justify-content:center;
  font-size:12px; font-weight:600; border:1px solid var(--line);
  background:linear-gradient(135deg, var(--bg-soft), transparent);
}
.msg-user .avatar{ background:linear-gradient(135deg, #1c2438, transparent) }
.msg-assistant .avatar{ background:linear-gradient(135deg, #1a2638, transparent) }
.msg-system .avatar{ background:linear-gradient(135deg, #381a1a, transparent) }

.stack{ display:flex; flex-direction:column; gap:6px; min-width:0 }
.msg-head{
  display:flex; align-items:center; gap:10px;
  color:var(--muted); font-size:12px; margin-bottom:-2px;
}
.msg-head .who{ font-weight:600 }
.msg-head .time{ opacity:0.8 }
.msg .copy-btn{ margin-left:auto }

.bubble{
  border:1px solid var(--line);
  background:var(--glass);
  border-radius:18px;
  padding:10px 12px;
  box-shadow: var(--shadow);
  max-width: min(76ch, 100%);
  overflow-wrap: anywhere;
}
/* Subtle role accents */
.msg-user .bubble{ border-color:#2a3550 }
.msg-assistant .bubble{ border-color:#24422a; background:linear-gradient(180deg, rgba(155,231,160,0.04), transparent), var(--glass) }
.msg-system .bubble{ border-color:#3c2a2a; background:linear-gradient(180deg, rgba(255,77,95,0.06), transparent), var(--glass) }

/* Markdown polish inside bubbles */
.bubble .md p{ margin:8px 0 }
.bubble .md pre{ margin:8px 0 0 }
.bubble .md code{ background: rgba(255,255,255,0.06); padding:0 4px; border-radius:6px }
.bubble .md ul{ margin:6px 0 6px 18px }
.bubble .md a{ text-decoration: underline dotted }

/* Typing dots */
.typing{
  position:sticky; bottom:8px; display:none; justify-content:center; gap:6px; padding:6px 0;
}
.typing[aria-hidden="false"]{ display:flex }
.typing span{
  width:8px; height:8px; border-radius:50%; background:#a6c8ff; opacity:0.75; animation: bounce 1.2s infinite ease-in-out;
}
.typing span:nth-child(2){ animation-delay: 0.15s }
.typing span:nth-child(3){ animation-delay: 0.3s }
@keyframes bounce{
  0%, 80%, 100% { transform: translateY(0); opacity:0.5 }
  40% { transform: translateY(-6px); opacity:1 }
}

/* Chat composer */
.composer{ position:relative }
.composer .toolbar{
  display:flex; align-items:center; justify-content:space-between; gap:10px; flex-wrap:wrap; margin-bottom:8px;
}
.file-btn{ cursor:pointer }
.attachments{ display:flex; gap:6px; flex-wrap:wrap }
.attach-chip{
  font-size:12px; padding:4px 8px; border-radius:999px; border:1px solid var(--line); background:rgba(255,255,255,0.04);
}
.switch{ display:inline-flex; align-items:center; gap:6px; cursor:pointer; user-select:none }
.switch input{ appearance:none; width:34px; height:20px; border-radius:999px; border:1px solid var(--line); position:relative; background:var(--bg-soft); outline:none }
.switch input::after{ content:''; position:absolute; top:2px; left:2px; width:16px; height:16px; border-radius:50%; background:var(--fg); transition:left var(--fast) ease }
.switch input:checked::after{ left:16px }
.hotkey{ font-size:12px }
kbd{
  font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
  border:1px solid var(--line); border-bottom-width:2px; padding:1px 4px; border-radius:6px;
  background:var(--bg-soft); font-size:11px;
}

#chat{ width:100%; min-height:110px; resize:vertical }

/* Mobile refinements */
@media (max-width: 900px){
  .grid2{ grid-template-columns: 1fr }
  .feed{ max-height:60vh }
  .composer{ position:sticky; bottom:0; z-index:5; background:var(--glass); border:1px solid var(--line); border-radius:var(--radius); box-shadow:var(--shadow); padding-bottom:8px }
}
@media (max-width: 700px){
  #plan .plan-item{ padding:5px 6px }
  .msg .copy-btn{ display:none } /* simplify on small screens */
}
